from rex.exploit import Exploit

class CGCType1Exploit(Exploit):
    '''
    A CGC exploit object, offers more flexibility than an Exploit object for the sake of the game.
    This should represent a Type 1 POV by allowing you to set many different registers to many different values.
    https://github.com/CyberGrandChallenge/cgc-release-documentation/blob/master/walk-throughs/understanding-cfe-povs.md
    '''

    def __init__(self, crash, register, bypasses_nx, bypasses_aslr):
        '''
        :param crash: a crash object which has been modified to exploit a vulnerability
        '''
        super(CGCType1Exploit, self).__init__(crash, bypasses_nx, bypasses_aslr)

        self.register = register

    def dump(self, filename=None):
        '''
        dumps a register setting exploit, depending on the script type specified the exploit will take the value to set
        and final IP value as arguments, either over-the-wire or via the command line
        :param filename: file to write the raw payload to
        '''
