import os
from collections import defaultdict
import importlib

import logging
l = logging.getLogger("rex.exploit.techniques")

from ..shellcode import Shellcode

from .linux_x86_binsh import LinuxX86Binsh
from .linux_amd64_binsh import LinuxAMD64Binsh
from .linux_arm_binsh import LinuxARMBinsh
from .linux_x86_jmpsp import LinuxX86JmpSP
from .linux_amd64_jmpsp import LinuxAMD64JmpSP
from .linux_arm_jmpsp import LinuxARMJmpSP
from .linux_x86_connectback import LinuxX86Connectback
from .linux_amd64_connectback import LinuxAMD64Connectback

from .cgc_x86_setregister import CGCX86SetRegister

Shellcodes = defaultdict(dict)
for s in Shellcode.__subclasses__():
    if not s.arch in Shellcodes[s.os]:
        Shellcodes[s.os][s.arch] = { }
    Shellcodes[s.os][s.arch][s.name] = s

Shellcodes = dict(Shellcodes)
